#!/bin/sh
DIR=$(cd "$(dirname "$0")" && pwd)
. "$DIR/.export-staged"

assertStaged

for FILE in $STAGED_FILES; do
    if echo "$FILE" | grep -qE '^.*/cmd/.*\.go$'; then

        docDate=$(stat -c %X docs/git_hooks.md)

        if [ "$((docDate + 60 * 5))" -lt "$(date +%s)" ]; then
            echo "! You need to regenerate the CLI docs (its too old)!"
            exit 1
        fi
    fi
done


echo "* CLI docs is up to date"