All these hooks run in parallel.